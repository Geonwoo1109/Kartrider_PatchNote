
var Key ="Key";
var allsee = "\u200d".repeat (500);

const Jsoup = org.jsoup.Jsoup;
const Fs = FileStream;
var NewMaster = [];
var Master = ["",
"[ê´€ë¦¬ì]_ì—í‹°ì„ ìƒ",
"[ê´€ë¦¬ì]_ì¸ì¸ê¹€ê¸°ë¦¬",
"[ê´€ë¦¬ì]_ì¸ì¸ê¹€ë¹„ì„œ",
"[ê´€ë¦¬ì]_Hyewonnn",
"[ê´€ë¦¬ì]_MerryZico",
"[ê´€ë¦¬ì]_ì»µë´ë©´",
"[ê´€ë¦¬ì]_K1ngZico",
"[ì„œí¬í„°]_ë¼ìŠ¤ì¹¼ê¸¸ëª¨ì¤‘",
"ì—í‹°ì„ ìƒ",
"ê¹€ê±´ìš°",
"LEGê±´ìš° / 18ë‚¨ / í¸ì§‘Â¤ì½”ë”©"];

function response(room, msg, sender, isGroupChat, replier, imageDB, packageName) {


try {

if (msg.startsWith(".ê´€ë¦¬ììœ„ì„ ")) {
  NewMaster = Fs.read ("/sdcard/ì¹´ìœ ëª¨/ê´€ë¦¬ìëª©ë¡").slice ("*");
  
  if (NewMaster.includes (sender) || sender == "ê¹€ê±´ìš°") {
  replier.reply ("["+msg.substr (7)+"] ë‹˜ì„ ê´€ë¦¬ì ëª©ë¡ì— ì¶”ê°€í•©ë‹ˆë‹¤.");
  Fs.append ("/sdcard/ì¹´ìœ ëª¨/ê´€ë¦¬ìëª©ë¡", msg.substr (7) + "*");
  }
}
if (msg == ".ê´€ë¦¬ìì´ˆê¸°í™”" && sender == "ê¹€ê±´ìš°") {
  Fs.write ("/sdcard/ì¹´ìœ ëª¨/ê´€ë¦¬ìëª©ë¡", "[ê´€ë¦¬ì]_ì—í‹°ì„ ìƒ*");
}
} catch (e) {
  replier.reply (e);
}
if (msg == ".ë´‡") replier.reply ("ë‹‰ë„¤ì„ í™•ì¸ë´‡ì— ê´€í•œ ì •ë³´ì…ë‹ˆë‹¤" + allsee
  +"\n\n\n[ì„¤ëª…]"+"\nì¹´íŠ¸ë¼ì´ë” ìœ ì €ì˜ ë‹‰ë„¤ì„ê³¼ ê°€ì¥ ìµœê·¼ì˜ ë§¤ì¹˜ê¸°ë¡ì„ ì•Œë ¤ì£¼ëŠ” ë´‡ì…ë‹ˆë‹¤. ì´ ì™¸ì—ë„ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤."
  +"\n\n[ëª…ë ¹ì–´ ëª©ë¡]" + "\n.ìœ ì € ë‹‰ë„¤ì„ ex).ìœ ì € ì—í‹°ì„ ìƒ\n.ë§¤ì¹˜ ë‹‰ë„¤ì„ ex).ë§¤ì¹˜ ì—í‹°ì„ ìƒ\n.ê´€ë¦¬ììœ„ì„ ì¹´í†¡ë‹‰ë„¤ì„ ex).ê´€ë¦¬ììœ„ì„ [ê´€ë¦¬ì]_ì—í‹°ì„ ìƒ"
  +"\n\n[ë´‡ ì‚¬ìš© ê°€ëŠ¥ì]\n" +
  Fs.read ("/sdcard/ì¹´ìœ ëª¨/ê´€ë¦¬ìëª©ë¡").split("*").join ("\n")
  +"\n\n[ì§ì ‘ ì‚¬ìš©í•´ë³´ê³ ì‹¶ë‹¤ë©´?]" + "\nì œ ì˜¤í”ˆí”„ë¡œí•„ì„ ëˆŒëŸ¬ ê°œì¸ì ìœ¼ë¡œ ì‚¬ìš©í•´ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
  NewMaster = Fs.read ("/sdcard/ì¹´ìœ ëª¨/ê´€ë¦¬ìëª©ë¡").slice ("*");
if ((room == "(PC)ì¹´íŠ¸ë¼ì´ë” ìœ ì €ë“¤ì˜ ëª¨ì„ğŸ”Š" && NewMaster.includes (sender))
  || room != "(PC)ì¹´íŠ¸ë¼ì´ë” ìœ ì €ë“¤ì˜ ëª¨ì„ğŸ”Š") {


if (msg.startsWith(".ìœ ì € ")) {
     try {
     User = msg.substr(4);
//     replier.reply (msg.substr (4));
    let data3 = Jsoup.connect ("https://api.nexon.co.kr/kart/v1.0/users/nickname/" + User)
    .header ("Authorization", Key).data ("nickname", User)
    .ignoreContentType(true).get().text();
    data3 = JSON.parse(data3);
    
     replier.reply (
     "ìœ ì € ê³ ìœ  Id: " + data3 ["accessId"]
     + "\nê²Œì„ ë‹‰ë„¤ì„: " + data3 ["name"]
     + "\në ˆë²¨: " + data3 ["level"]);
   } catch (e) {
     replier.reply("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¼ì´ë” ì´ë¦„ì…ë‹ˆë‹¤." + "\n\nì£¼ì˜: ìµœê·¼ì— ë‹‰ë„¤ì„ì„ ë³€ê²½í•˜ì…¨ê±°ë‚˜ ë³µê·€í•˜ì‹  ì´ë ¥ì´ ìˆë‹¤ë©´ ì¸ì‹ì´ ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
   }
  }

//ë§¤ì¹˜ë°ì´í„°

if (msg.startsWith(".ë§¤ì¹˜ ")) {
  
  try {
    let userId = Jsoup.connect ("https://api.nexon.co.kr/kart/v1.0/users/nickname/" + msg.substr(4))
    .header ("Authorization", Key).data ("nickname", msg.substr (4))
    .ignoreContentType(true).get().text();
    
    let matchData = Jsoup.connect (
    "https://api.nexon.co.kr/kart/v1.0/users/"
    + JSON.parse (userId)["accessId"] +
    "/matches?start_date=&end_date=&offset=&limit=1&match_types=")
    .header ("Authorization", Key).ignoreContentType(true).get().text();
    
    try {
    let Final = Jsoup.connect(
    "https://api.nexon.co.kr/kart/v1.0/matches/"
    + JSON.parse (matchData).matches[0].matches[0].matchId)
    .header ("Authorization", Key).ignoreContentType(true).get().text();
    
    var a = [];
    for (i=0; i<JSON.parse (Final)["players"].length; i++) {
      
      a.push (JSON.parse (Final).players[i].characterName);
      //replier.reply (JSON.parse (Final).players[i].characterName);
    }
    replier.reply ("[ê°œì¸ì „] ì°¸ì—¬ì„ ìˆ˜ëª©ë¡\n\n" + a.join ("\n"));
    a = [];
    replier.reply (a);
    
  } catch (e1) {
    let Final = Jsoup.connect(
    "https://api.nexon.co.kr/kart/v1.0/matches/"
    + JSON.parse (matchData).matches[0].matches[0].matchId)
    .header ("Authorization", Key).ignoreContentType(true).get().text();
    
    a = [];
    for (i=0; i<JSON.parse (Final).teams[0].players.length; i++) {
      a.push (JSON.parse (Final).teams[0].players[i].characterName);
    }
    a.push ("vs");
    
    for (i=0; i<JSON.parse (Final).teams[0].players.length; i++) {
      a.push (JSON.parse (Final).teams[1].players[i].characterName);
    }
    replier.reply ("[íŒ€ì „] ì°¸ì—¬ì„ ìˆ˜ëª©ë¡\n\n" + a.join ("\n"));
    a = [];
    
  }

  } catch (e) {
    replier.reply ("ê¸°ë¡ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
  }


}
  
  
  
}
}
